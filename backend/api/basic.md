
### API 设计
API 的命令模式和 Restful 模式。  
> 命令模式：是中心化的思想。  
> 1、所有的功能都使用同一个 URI  
> 2、在 HTTP 协议中，提供了一个方法参数：method，通过方法参数来传递具体使用的功能，不同的方法表示使用不同的操作。  
> 
> Restful 模式：是分而治之的思想。
> 1、每个功能和操作都有一个对应的 URI  
> 2、URI 信息是在 HTTP 头上进行传递的


### API 设计规范
API 的设计应该秉着简单、易懂、使用方便的原则来提供。  

1、URI 采用非驼峰式无下划线的命名，而参数使用非驼峰式有下滑线的命名。  
> /std/trade/orderquery  
> /sys/merchant/agreeinfoquery  
> /std/balance/remit  
> /std/bill/trademonthdownload

2、使用 RESTful 风格的 API，为每一个操作 API 显示的定义不同的 URI 来区别。  
3、任何一个 URI 或者参数，一般由最多 3 个单词组成，尽量使用缩写的单词。  
4、单词要使用英文来命名，英文要尽量准确表达其意，有固定缩写的词就用固定缩写，例如：Identity->ID，没有固定缩写的，缩写的单词通常采用省略单词的元音来构造，例如：method -> mthd。  
5、建设一套适合业务的数据词典，术语按照数据词典命名，在多个 API 产品中保持风格统一，同一产品中对同一事物命名要前后一致。  

| 中文名 | 英文名 | URI | 参数 |  
| :--- | :--- | :--- | :--- |  
| 用户 | user  |  user  |  user |  
| 商户 | merchant  |  merchant  |  merchant |  
| 商户编号  |  merchantno |  merchantno | merchant_no |  
| 主商户编号 |  parentmerchantno  |  parentmerchantno  |  parent_merchant_no|  
| 支付 | payment | payment | payment |   
| 订单 | order |  order |  order |  
| 查询 | query  | query |  query |  
| 出款 | remit  | remit  | remit |  
| 退款 | refund | refund  | rfnd |  
| 注册 / 入网 | register | reg | reg |  

6、原则上一个标识符不超过 20 个字母。  
7、在 URI 的设计上，要简单明了、风格统一、一目了然，不需要类似版本和 REST 等提示信息。  
8、使用的域名必须是英文命名并且具有品牌名称。  
9、一般不需要设计扩展字段，即使设计了扩展字段，有新功能需要新字段的时候，也一样需要开发，因为新需求还是会有新逻辑的实现，即使预留了扩展字段也不能达到在不改动代码的前提下实现新需求。  
10、URL 路径中首选小写字母，路径名词均为复数；应该使用连字符”-“来提高 URL 的可读性，而不是使用下划线”\_”。  

### API 范围查询
不提倡为客户提供这样的范围查询。  
在交易系统中，不应该对外提供范围查询，因为这会影响交易系统的性能，严重情况下范围查询会拖垮交易系统，因此这类的查询系统应该在支付核心的上层系统中定义业务订单系统，在订单系统中为商户提供多样化的查询需求，并与交易系统分离。  

如果真的为客户提供了范围查询，一定要进行分页处理，并提供一定的限流措施，因为在严重情况下范围查询的数据量比较大时，会产生巨大的流量，可能会堵塞机房内外的专线。  

### API ID 设计
当一个平台做的越来越大，从开放平台对外提供的 API 产品也越来越多，不同的 API 产品之间的权限需要进行控制，不能让 A 产品的客户访问 B 产品功能，这就需要对不同的产品提供不同的 ID，APPID 就是满足这个需求的。  

一个客户可以开通多个产品，每个产品对应一个 APPID，在使用 API 和我们的开放平台对接的时候，必须提供 APPID，来验证这个客户是否开通了这个产品，这是很好的一个隔离模式的实践。

### API 安全策略
安全需求也是需求的一种，无非这几种：防篡改、防偷窥、防泄漏、防抵赖、防中间人攻击。  
要满足这些安全需求，我们采用不同的安全策略和方法，从密码学的历史开始说起，它一共经历了三个时代：算法加密时代（通过算法校验） -> 对称加密时代（比如 3DES、AES） -> 非对称加密时代（比如 RSA）。  


