
### Mysql 数据库的优化方式
> 1. 合理的设计表结构、表索引
> 2. 不在数据库中做运算
> 3. 控制单表数据量
> 4. 数据量过大进行读写分离，使用INNODB存储引擎
> 5. 不再数据表中存储图片

### Mysql 慢查询及优化
MySQL 中查询超过指定时间的语句，被称之为「慢查询」。  

优化 SQL 语句，创建合适的索引。

### Mysql SQL 语句优化
> 1. 避免使用 Like 模糊查询
> 2. 只列出需要查询的字段，而不是所有
> 3. 不在 MySQL 中进行运算，减轻 MySQL 的压力
> 4. 经常查询的字段，创建合适的索引，提高查询效率

### Mysql 读写分离
读写分离通常指的是让主库进行事务性查询（插入、更新、删除）操作，而让从库进行 SELECT 查询操作，通俗来说，就是主库写、从库读。  

读写分离的意义：  
> 1、对大部分 web 应用而言，都是读多写少，我们设计一主多从，可以提高系统的并发处理能力；  
> 2、增加冗余备份，一处写入（主），多处同步（从），可以提高系统的可用性；  
> 3、读写分离，让主库专注于写，让读库专注于读，区分优化读库和写库，从而提升数据库性能。  

读写分离的实现：  
通过读写分离的定义，我们知道，所谓读写分离，就是写入操作都在主库完成，查询操作都在从库完成。  
所以，在代码层级，我们需要将查询和写入操作区分开，通过不同的数据库连接实现，对于简单的读写分离，通过配置文件完成即可，对于多个主库 / 从库，从配置数组中随机选取一个建立连接即可，对于更复杂的数据库集群，可以通过数据库中间件（比如 Mycat）来建立连接。  
在数据库级别，我们要实现主库记录通过同步机制实时同步到从库，以便随时可以从从库查询到最新记录，关于这一块可以通过配置主库和从库通过 binlog 日志实现数据同步复制。  

数据延迟的问题：  
binlog 同步机制简单方便，但是由于需要从库通过网络请求去主库拉取数据，对于高并发场景，可能会由于系统负载、网络延迟问题导致从库和主库短期内的数据不一致（毫秒级或者秒级），针对这种情况，对于简单的中小型系统，可以在写入操作完成后强制查询操作使用主库连接来解决，比如 Laravel 的数据库 sticky 配置项底层实现就是这么干的，此外我们还可以借助缓存层来解决这种不一致性，然后主从同步之后触发缓存更新。  
需要注意的是，在分布式系统中，绝对的数据一致性是无法保证的，我们必须在 CAP 中找到一个平衡。

### Mysql 分库分表设计
> 1. 垂直分表
> 垂直分表在日常开发和设计中比较常见，通俗的说法叫做“大表拆小表”，某个表中的字段比较多，可以新建立一张“扩展表”，将不经常使用或者长度较大的字段，拆分出去放到“扩展表”中。
> 
> 2. 垂直分库
> 基本的思路就是按照业务模块来划分出不同的数据库，而不是像早期一样将所有的数据表都放到同一个数据库中。  
> 
> 3. 水平分表
> 水平分表也称为横向分表，比较容易理解，就是将表中不同的数据行按照一定规律分布到不同的数据库表中（这些表保存在同一个数据库中），这样来降低单表数据量，优化查询性能。 
> 
> 4. 水平分库分表
> 水平分库分表与上面讲到的水平分表的思想相同，唯一不同的就是将这些拆分出来的表保存在不同的数据库中。

### Mysql 死锁与优化
死锁一般是事务相互等待对方资源，最后形成环路，而无法继续运行。

> 产生死锁的原因：
> 
> 1. 系统资源不足；
> 2. 进程运行推进的顺序不合适；
> 3. 资源分配不当等；
> 
> 如何有效降低死锁：
> 
> 1. 按同一顺序访问资源；
> 2. 避免事务中的用户交互；
> 3. 保持事务简短并在一个批处理中；
> 4. 使用低隔离级别；
> 5. 使用绑定连接
